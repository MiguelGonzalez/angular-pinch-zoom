/*! angular-pinch-zoom - v0.2.3 */
angular.module("ngPinchZoom",[]).directive("ngPinchZoom",function(){function t(t,n,e){function i(t){var n=t.originalEvent?t.originalEvent.touches:t.touches;k=n[0].clientX,S=n[0].clientY,D=X,E=Y,M=0,x=0,N?(o(),t.preventDefault()):(N=!0,setTimeout(function(){N=!1},300))}function o(){w=d=p=1,X=0,Y=0,s()}function c(t){var e=0;if(t.preventDefault(),t.deltaY?e=t.deltaY:t.wheelDelta&&(e=-t.wheelDelta),!(p>m&&0>e)){var i=n[0].getBoundingClientRect(),o=t.pageX-i.left-window.pageXOffset,c=t.pageY-i.top-window.pageYOffset;void 0===T&&(P=T=i.width,R=Z=i.height);var a=o-X,l=c-Y,r=a/T,u=l/Z,f=.1;0>e?(T+=T*f,Z+=Z*f):(T-=T*f,Z-=Z*f),p=T/P,X=o-T*r,Y=c-Z*u,X>0?X=0:P-T>X&&(X=P-T),Y>0?Y=0:R-Z>Y&&(Y=R-Z),1>=p&&(p=1,X=0,Y=0,T=P,Z=R),s()}}function a(t){var e=t.originalEvent?t.originalEvent.touches:t.touches;""===g&&(1===e.length&&p>1?g="swipe":2===e.length&&(g="pinch",d=p,v=r(e),b=e[0].clientX-parseInt((e[0].clientX-e[1].clientX)/2,10)-n[0].offsetLeft-D,I=e[0].clientY-parseInt((e[0].clientY-e[1].clientY)/2,10)-n[0].offsetTop-E)),"swipe"===g?(t.preventDefault(),M=e[0].clientX-k,x=e[0].clientY-S,X=D+M,Y=E+x,s()):"pinch"===g&&(t.preventDefault(),h=r(e),w=h/v,p=w*d,X=b*(1-w)+D+M,Y=I*(1-w)+E+x,1>p&&(p=1,X=0,Y=0),console.log("Relative Scale: "+w),console.log("originX: "+b),console.log("scale: "+p),console.log("positionX: "+X),s())}function l(t){var n=t.originalEvent?t.originalEvent.touches:t.touches;""===g||n.length>0||(1>p?(p=1,X=0,Y=0):p>m?(p=m,w=p/d,X=b*(1-w)+D+M,Y=I*(1-w)+E+x):(X>0?X=0:u*(1-p)>X&&(X=u*(1-p)),Y>0?Y=0:f*(1-p)>Y&&(Y=f*(1-p))),s(.1),g="")}function r(t){var n=Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2));return parseInt(n,10)}function s(t){var e=t?"all cubic-bezier(0,0,.5,1) "+t+"s":"",i=[p,0,0,p,X,Y],o="matrix("+i.join(",")+")";n.css({"-webkit-transition":e,transition:e,"-webkit-transform":o+" translate3d(0,0,0)",transform:o})}var u,f,g="",h=0,v=0,p=1,w=1,d=1,m=parseInt(e.maxScale,10);(isNaN(m)||1>=m)&&(m=3);var X=0,Y=0,D=0,E=0,b=0,I=0,k=0,S=0,M=0,x=0,N=!1,O=new Image;O.onload=function(){u=n[0].clientWidth,f=n[0].clientHeight,n.css({"-webkit-transform-origin":"0 0","transform-origin":"0 0"}),n.on("touchstart",i),n.on("touchmove",a),n.on("touchend",l),n.on("wheel",c)},e.ngSrc?O.src=e.ngSrc:O.src=e.src;var P,R,T,Z}var n={restrict:"A",scope:!1,link:t};return n});