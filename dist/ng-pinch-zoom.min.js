/*! angular-pinch-zoom - v0.2.5 */
angular.module("ngPinchZoom",[]).directive("ngPinchZoom",function(){function t(t,e,n){function i(t){var e=t.originalEvent?t.originalEvent.touches:t.touches;1==e.length?x?(o(),t.preventDefault()):(x=!0,void 0!==O&&(clearTimeout(O),O=void 0),O=setTimeout(function(){x=!1,O=void 0},275)):(k=e[0].clientX,S=e[0].clientY,D=X,E=Y,M=0,T=0)}function o(){d=w=p=1,X=0,Y=0,s()}function c(t){var n=0;if(t.preventDefault(),t.deltaY?n=t.deltaY:t.wheelDelta&&(n=-t.wheelDelta),!(p>m&&0>n)){var i=e[0].getBoundingClientRect(),o=t.pageX-i.left-window.pageXOffset,c=t.pageY-i.top-window.pageYOffset;void 0===Z&&(P=Z=i.width,R=j=i.height);var a=o-X,l=c-Y,r=a/Z,u=l/j,g=.1;0>n?(Z+=Z*g,j+=j*g):(Z-=Z*g,j-=j*g),p=Z/P,X=o-Z*r,Y=c-j*u,X>0?X=0:P-Z>X&&(X=P-Z),Y>0?Y=0:R-j>Y&&(Y=R-j),1>=p&&(p=1,X=0,Y=0,Z=P,j=R),s()}}function a(t){var n=t.originalEvent?t.originalEvent.touches:t.touches;""===f&&(1===n.length&&p>1?f="swipe":2===n.length&&(f="pinch",w=p,h=r(n),b=n[0].clientX-parseInt((n[0].clientX-n[1].clientX)/2,10)-e[0].offsetLeft-D,I=n[0].clientY-parseInt((n[0].clientY-n[1].clientY)/2,10)-e[0].offsetTop-E)),"swipe"===f?(t.preventDefault(),M=n[0].clientX-k,T=n[0].clientY-S,X=D+M,Y=E+T,s()):"pinch"===f&&(t.preventDefault(),v=r(n),d=v/h,p=d*w,X=b*(1-d)+D+M,Y=I*(1-d)+E+T,1>p&&(p=1,X=0,Y=0),console.log("Relative Scale: "+d),console.log("originX: "+b),console.log("scale: "+p),console.log("positionX: "+X),s())}function l(t){var e=t.originalEvent?t.originalEvent.touches:t.touches;""===f||e.length>0||(1>p?(p=1,X=0,Y=0):p>m?(p=m,d=p/w,X=b*(1-d)+D+M,Y=I*(1-d)+E+T):(X>0?X=0:u*(1-p)>X&&(X=u*(1-p)),Y>0?Y=0:g*(1-p)>Y&&(Y=g*(1-p))),s(.1),f="")}function r(t){var e=Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2));return parseInt(e,10)}function s(t){var n=t?"all cubic-bezier(0,0,.5,1) "+t+"s":"",i=[p,0,0,p,X,Y],o="matrix("+i.join(",")+")";e.css({"-webkit-transition":n,transition:n,"-webkit-transform":o+" translate3d(0,0,0)",transform:o})}var u,g,f="",v=0,h=0,p=1,d=1,w=1,m=parseInt(n.maxScale,10);(isNaN(m)||1>=m)&&(m=3);var X=0,Y=0,D=0,E=0,b=0,I=0,k=0,S=0,M=0,T=0,x=!1,N=new Image;N.onload=function(){u=e[0].clientWidth,g=e[0].clientHeight,e.css({"-webkit-transform-origin":"0 0","transform-origin":"0 0"}),e.on("touchstart",i),e.on("touchmove",a),e.on("touchend",l),e.on("wheel",c)},n.ngSrc?N.src=n.ngSrc:N.src=n.src;var O,P,R,Z,j}var e={restrict:"A",scope:!1,link:t};return e});