/*! angular-pinch-zoom - v0.2.2 */
angular.module("ngPinchZoom",[]).directive("ngPinchZoom",function(){function t(t,e,n){function i(t){var e=t.originalEvent?t.originalEvent.touches:t.touches;k=e[0].clientX,S=e[0].clientY,D=X,E=Y,M=0,T=0,x?(o(),t.preventDefault()):(x=!0,setTimeout(function(){x=!1},300))}function o(){w=m=p=1,X=0,Y=0,s()}function c(t){var n=0;t.preventDefault();var i=!1;t.deltaY?n=t.deltaY:t.wheelDelta&&(n=-t.wheelDelta),0>n&&(i=!0);var o=e[0].getBoundingClientRect(),c=t.pageX-o.left-window.pageXOffset,a=t.pageY-o.top-window.pageYOffset;b=c-e[0].offsetLeft-X,I=a-e[0].offsetTop-X,M=0,T=0;var l=.2;i?w+=l:w-=l,i&&0===m&&(m=1+l),p=w*m,X=b*(1-w)/2,Y=I*(1-w)/2,1>=p&&(w=m=p=1,X=0,Y=0),s()}function a(t){var n=t.originalEvent?t.originalEvent.touches:t.touches;""===g&&(1===n.length&&p>1?g="swipe":2===n.length&&(g="pinch",m=p,h=r(n),b=n[0].clientX-parseInt((n[0].clientX-n[1].clientX)/2,10)-e[0].offsetLeft-D,I=n[0].clientY-parseInt((n[0].clientY-n[1].clientY)/2,10)-e[0].offsetTop-E)),"swipe"===g?(t.preventDefault(),M=n[0].clientX-k,T=n[0].clientY-S,X=D+M,Y=E+T,s()):"pinch"===g&&(t.preventDefault(),v=r(n),w=v/h,p=w*m,X=b*(1-w)+D+M,Y=I*(1-w)+E+T,1>p&&(p=1,X=0,Y=0),console.log("Relative Scale: "+w),console.log("originX: "+b),console.log("scale: "+p),console.log("positionX: "+X),s())}function l(t){var e=t.originalEvent?t.originalEvent.touches:t.touches;""===g||e.length>0||(1>p?(p=1,X=0,Y=0):p>d?(p=d,w=p/m,X=b*(1-w)+D+M,Y=I*(1-w)+E+T):(X>0?X=0:f*(1-p)>X&&(X=f*(1-p)),Y>0?Y=0:u*(1-p)>Y&&(Y=u*(1-p))),s(.1),g="")}function r(t){var e=Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2));return parseInt(e,10)}function s(t){var n=t?"all cubic-bezier(0,0,.5,1) "+t+"s":"",i=[p,0,0,p,X,Y],o="matrix("+i.join(",")+")";e.css({"-webkit-transition":n,transition:n,"-webkit-transform":o+" translate3d(0,0,0)",transform:o})}var f,u,g="",v=0,h=0,p=1,w=1,m=1,d=parseInt(n.maxScale,10);(isNaN(d)||1>=d)&&(d=3);var X=0,Y=0,D=0,E=0,b=0,I=0,k=0,S=0,M=0,T=0,x=!1,L=new Image;L.onload=function(){f=e[0].clientWidth,u=e[0].clientHeight,e.css({"-webkit-transform-origin":"0 0","transform-origin":"0 0"}),e.on("touchstart",i),e.on("touchmove",a),e.on("touchend",l),e.on("wheel",c)},n.ngSrc?L.src=n.ngSrc:L.src=n.src}var e={restrict:"A",scope:!1,link:t};return e});