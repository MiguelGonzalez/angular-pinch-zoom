/*! angular-pinch-zoom - v0.2.6 */
angular.module("ngPinchZoom",[]).directive("ngPinchZoom",function(){function e(e,t,n){function i(e){var t=e.originalEvent?e.originalEvent.touches:e.touches;t.length>=2&&(x=!1,void 0!==O&&(clearTimeout(O),O=void 0)),k=t[0].clientX,S=t[0].clientY,D=X,E=Y,T=0,M=0,1==t.length&&(x?(o(),e.preventDefault()):(x=!0,void 0!==O&&(clearTimeout(O),O=void 0),O=setTimeout(function(){x=!1,O=void 0},275)))}function o(){d=w=p=1,X=0,Y=0,s()}function c(e){var n=0;if(e.preventDefault(),e.deltaY?n=e.deltaY:e.wheelDelta&&(n=-e.wheelDelta),!(p>m&&0>n)){var i=t[0].getBoundingClientRect(),o=e.pageX-i.left-window.pageXOffset,c=e.pageY-i.top-window.pageYOffset;void 0===Z&&(P=Z=i.width,R=j=i.height);var l=o-X,a=c-Y,r=l/Z,u=a/j,g=.1;0>n?(Z+=Z*g,j+=j*g):(Z-=Z*g,j-=j*g),p=Z/P,X=o-Z*r,Y=c-j*u,X>0?X=0:P-Z>X&&(X=P-Z),Y>0?Y=0:R-j>Y&&(Y=R-j),1>=p&&(p=1,X=0,Y=0,Z=P,j=R),s()}}function l(e){var n=e.originalEvent?e.originalEvent.touches:e.touches;""===v&&(1===n.length&&p>1?v="swipe":2===n.length&&(v="pinch",w=p,h=r(n),b=n[0].clientX-parseInt((n[0].clientX-n[1].clientX)/2,10)-t[0].offsetLeft-D,I=n[0].clientY-parseInt((n[0].clientY-n[1].clientY)/2,10)-t[0].offsetTop-E)),"swipe"===v?(e.preventDefault(),T=n[0].clientX-k,M=n[0].clientY-S,X=D+T,Y=E+M,s()):"pinch"===v&&(e.preventDefault(),f=r(n),d=f/h,p=d*w,X=b*(1-d)+D+T,Y=I*(1-d)+E+M,1>p&&(p=1,X=0,Y=0),console.log("Relative Scale: "+d),console.log("originX: "+b),console.log("scale: "+p),console.log("positionX: "+X),s())}function a(e){var t=e.originalEvent?e.originalEvent.touches:e.touches;""===v||t.length>0||(1>p?(p=1,X=0,Y=0):p>m?(p=m,d=p/w,X=b*(1-d)+D+T,Y=I*(1-d)+E+M):(X>0?X=0:u*(1-p)>X&&(X=u*(1-p)),Y>0?Y=0:g*(1-p)>Y&&(Y=g*(1-p))),s(.1),v="")}function r(e){var t=Math.sqrt(Math.pow(e[0].clientX-e[1].clientX,2)+Math.pow(e[0].clientY-e[1].clientY,2));return parseInt(t,10)}function s(e){var n=e?"all cubic-bezier(0,0,.5,1) "+e+"s":"",i=[p,0,0,p,X,Y],o="matrix("+i.join(",")+")";t.css({"-webkit-transition":n,transition:n,"-webkit-transform":o+" translate3d(0,0,0)",transform:o})}var u,g,v="",f=0,h=0,p=1,d=1,w=1,m=parseInt(n.maxScale,10);(isNaN(m)||1>=m)&&(m=3);var X=0,Y=0,D=0,E=0,b=0,I=0,k=0,S=0,T=0,M=0,x=!1,N=new Image;N.onload=function(){u=t[0].clientWidth,g=t[0].clientHeight,t.css({"-webkit-transform-origin":"0 0","transform-origin":"0 0"}),t.on("touchstart",i),t.on("touchmove",l),t.on("touchend",a),t.on("wheel",c)},n.ngSrc?N.src=n.ngSrc:N.src=n.src;var O,P,R,Z,j}var t={restrict:"A",scope:!1,link:e};return t});